# 連絡帳文例ナレッジベース

このフォルダには、AIが文例生成時に参考にする実際の連絡帳文例が格納されています。

## ファイル構造

- `contactExamples.json` - 連絡帳文例のデータベース

## 文例の追加方法

`contactExamples.json`に新しい文例を追加することで、AIがその文体や形式を学習して生成に反映します。

### JSON形式

```json
{
  "examples": [
    {
      "age": 0,
      "month": 4,
      "category": "daily_report",
      "text": "今日は、午前中お散歩に出かけました。○○くんはちょうちょやお花を指さして『あ!あ!』と何度も教えてくれました!公園から帰る時は公園に向かって『バイバイ』をしていて、とってもかわいかったです。",
      "tags": ["散歩", "成長"]
    }
  ]
}
```

### フィールドの説明

| フィールド | 型 | 必須 | 説明 |
|-----------|------|------|------|
| `age` | number | ○ | 対象年齢（0〜5歳） |
| `month` | number/null | - | 対象月（1〜12）。特定月でない場合は`null` |
| `category` | string | ○ | カテゴリ（下記参照） |
| `text` | string | ○ | 実際の文例テキスト |
| `tags` | array | - | 検索用タグ（任意） |

### カテゴリ一覧

- `daily_report` - 日々の様子報告
- `daily_activity` - 日々の活動記録
- `event_notice` - 行事・イベントのお知らせ
- `absence` - 欠席連絡
- `pickup` - お迎え時間変更

## 文例追加の例

### 0歳児の4月の散歩の文例を追加

```json
{
  "age": 0,
  "month": 4,
  "category": "daily_report",
  "text": "今日は、午前中お散歩に出かけました。○○くんはちょうちょやお花を指さして『あ!あ!』と何度も教えてくれました!",
  "tags": ["散歩", "春"]
}
```

### 1歳児の月を問わない活動記録を追加

```json
{
  "age": 1,
  "month": null,
  "category": "daily_activity",
  "text": "今日の午前中は公園までお散歩に行きました。○○くんは最近虫に興味があるようで、ダンゴムシを触ろうとしたり、アリを見つけると嬉しそうに指さして教えてくれます。",
  "tags": ["散歩", "興味・関心"]
}
```

## 仕組み

1. ユーザーがLINEで「1歳児の散歩の文例を書いて」と送信
2. システムが年齢（1歳）とカテゴリ（散歩→daily_activity）を自動抽出
3. 該当する文例を`contactExamples.json`から検索
4. 見つかった文例をプロンプトに含めてAIに送信
5. AIがその文体と形式を参考にして新しい文例を生成

### フォールバック機能

該当する例文が見つからない場合、システムは段階的に条件を緩めて検索します。

**検索の優先順位:**
1. 完全一致（年齢 + 月 + カテゴリすべて一致）
2. 年齢 + カテゴリ（月は異なるが参考になる）
3. 年齢のみ（同じ年齢の他の活動例）
4. カテゴリのみ（他の年齢だが同じ活動例）
5. 全例文から取得（最低限の文体参考）

**例:** 「3歳児の12月の散歩の文例」を依頼した場合
- 3歳・12月・散歩の例文がない
- → 3歳・散歩（月は問わず）の例文を探す
- → なければ3歳の例文を探す
- → なければ散歩の例文（年齢問わず）を探す

これにより、完全一致がなくても近い例文を参考に生成できます。

## 注意事項

- 文例は3〜5個程度あれば効果的です
- 実際の保育現場で使用されている自然な文章を追加してください
- 個人情報（実名など）は「○○くん」「○○ちゃん」に置き換えてください
- JSONの構文エラーに注意してください（カンマ、括弧の閉じ忘れなど）

## 今後の拡張案

- より細かいカテゴリ分類
- 季節ごとの文例
- 保護者への依頼事項のパターン
- 感謝や労いの表現パターン
