# 連絡帳文例ナレッジベース

このフォルダには、AIが文例生成時に参考にする実際の連絡帳文例が格納されています。

## ファイル構造

- `contactExamples.json` - 連絡帳文例のデータベース

## 文例の追加方法

`contactExamples.json`に新しい文例を追加することで、AIがその文体や形式を学習して生成に反映します。

### JSON形式

```json
{
  "examples": [
    {
      "age": 0,
      "month": 4,
      "text": "今日は、午前中お散歩に出かけました。○○さんはちょうちょやお花を指さして『あ!あ!』と何度も教えてくれました!公園から帰る時は公園に向かって『バイバイ』をしていて、とってもかわいかったです。",
      "tags": ["散歩", "成長", "日常"]
    }
  ]
}
```

### フィールドの説明

| フィールド | 型 | 必須 | 説明 |
|-----------|------|------|------|
| `age` | number | ○ | 対象年齢（0〜5歳） |
| `month` | number/null | - | 対象月（1〜12）。特定月でない場合は`null` |
| `text` | string | ○ | 実際の文例テキスト |
| `tags` | array | ○ | 検索用タグ（下記参照） |

### よく使うタグ一覧

- `散歩` - お散歩・公園での活動
- `遊び` - 室内・屋外での遊び
- `食事` - 給食・おやつ
- `睡眠` - お昼寝
- `日常` - 日々の様子・活動
- `行事` - イベント・遠足・運動会
- `お知らせ` - 保護者への連絡事項
- `欠席` - 欠席連絡
- `お迎え` - お迎え時間変更
- `成長` - できるようになったこと
- `興味・関心` - 子どもの興味・関心

※複数のタグを組み合わせて柔軟に検索できます

## 文例追加の例

### 0歳児の4月の散歩の文例を追加

```json
{
  "age": 0,
  "month": 4,
  "text": "今日は、午前中お散歩に出かけました。○○さんはちょうちょやお花を指さして『あ!あ!』と何度も教えてくれました!",
  "tags": ["散歩", "成長", "日常"]
}
```

### 1歳児の月を問わない活動記録を追加

```json
{
  "age": 1,
  "month": null,
  "text": "今日の午前中は公園までお散歩に行きました。○○さんは最近虫に興味があるようで、ダンゴムシを触ろうとしたり、アリを見つけると嬉しそうに指さして教えてくれます。",
  "tags": ["散歩", "興味・関心", "成長", "日常"]
}
```

### 2歳児の給食の様子を追加

```json
{
  "age": 2,
  "month": null,
  "text": "今日の給食はカレーライスでした。○○さんは『おいしい!』と言いながらモリモリ食べていました。スプーンも上手に使えるようになってきましたよ。",
  "tags": ["食事", "成長", "日常"]
}
```

## 仕組み

1. ユーザーがLINEで「1歳児の散歩の文例を書いて」と送信
2. システムが年齢（1歳）とタグ（散歩）を自動抽出
3. 該当する文例を`contactExamples.json`から検索
4. 見つかった文例をプロンプトに含めてAIに送信
5. AIがその文体と形式を参考にして新しい文例を生成

### タグベースの柔軟な検索

タグは複数指定でき、いずれかが一致すればマッチします。

**例:** 「1歳児の散歩と遊びの文例」→ tags: ["散歩", "遊び"]
- 散歩タグを持つ文例と遊びタグを持つ文例が両方検索される

### フォールバック機能

該当する例文が見つからない場合、システムは段階的に条件を緩めて検索します。

**検索の優先順位:**
1. 完全一致（年齢 + 月 + タグすべて一致）
2. 年齢 + タグ（月は異なるが参考になる）
3. 年齢のみ（同じ年齢の他の活動例）
4. タグのみ（他の年齢だが同じタグの例文）
5. 全例文から取得（最低限の文体参考）

**例:** 「3歳児の12月の散歩の文例」を依頼した場合
- 3歳・12月・散歩タグの例文がない
- → 3歳・散歩タグ（月は問わず）の例文を探す
- → なければ3歳の例文を探す
- → なければ散歩タグの例文（年齢問わず）を探す

これにより、完全一致がなくても近い例文を参考に生成できます。

## 注意事項

- 文例は3〜5個程度あれば効果的です
- 実際の保育現場で使用されている自然な文章を追加してください
- 個人情報（実名など）は「○○くん」「○○ちゃん」に置き換えてください
- JSONの構文エラーに注意してください（カンマ、括弧の閉じ忘れなど）

## 今後の拡張案

- より細かいカテゴリ分類
- 季節ごとの文例
- 保護者への依頼事項のパターン
- 感謝や労いの表現パターン
